<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Notepad&nbsp;RT</title>

    <!-- WinJS references -->
    <link href="//Microsoft.WinJS.1.0/css/ui-dark.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.1.0/js/base.js"></script>
    <script src="//Microsoft.WinJS.1.0/js/ui.js"></script>

    <!-- Notepad_RT references -->
    <!--<link href="/css/default.css" rel="stylesheet" />-->
    
    <script src="/pages/editor/editorPage.js"></script>
    <script src="/ace-src/ace.js"></script>
    <!--<script src="/are-src/mode-css.js"></script>
    <script src="/are-src/mode-csharp.js"></script>
    <script src="/are-src/mode-java.js"></script>
    <script src="/are-src/mode-html.js"></script>
    <script src="/are-src/mode-javascript.js"></script>-->

<style type="text/css">
    #editor { 
        position: absolute;
        top: 80px;
        right: 0;
        bottom: 0;
        left: 0;
        
    }

    textarea {
        text-indent: -9999px;
    }
</style>
    <script>

        function configureEditorFromSettings() {
            var editor = ace.edit("editor"),
                editorSession = editor.getSession(),
                settings = Windows.Storage.ApplicationData.current.localSettings.values;

            //console.log(editor);
            settings['fontSize'] = settings['fontSize'] || 12;
            settings['highlightActiveLine'] = (settings['highlightActiveLine'] === undefined ? false : settings['highlightActiveLine']);
            settings['showInvisibleCharacters'] = (settings['showInvisibleCharacters'] === undefined ? false : settings['showInvisibleCharacters']);
            settings['theme'] = settings['theme'] || 'ace/theme/textmate';
            settings['mode'] = settings['mode'] || 'ace/mode/text';
            settings['useHardTabs'] = (settings['useHardTabs'] === undefined ? true : settings['useHardTabs']);
            settings['showIndentGuides'] = (settings['showIndentGuides'] === undefined ? true : settings['showIndentGuides']);
            settings['showGutter'] = (settings['showGutter'] === undefined ? true : settings['showGutter']);

            editorSession.setMode(settings['mode']);
            editor.setTheme(settings['theme']);

            console.log(settings['mode'] + " " + settings['theme']);
            document.getElementById('editor').style.fontSize = settings['fontSize'] + 'px';


            editorSession.setUseWrapMode(true);
            editorSession.setUseSoftTabs(settings['useHardTabs']);
            editor.setHighlightActiveLine(settings['highlightActiveLine']);
            editor.setShowInvisibles(settings['showInvisibleCharacters']);


        }
        function init() {
            console.log("init");
            configureEditorFromSettings();
            Windows.Storage.ApplicationData.current.addEventListener("datachanged", configureEditorFromSettings);
        }
    </script>
</head>
<body>
    <header aria-label="Header content" role="banner">
        
        <h1 class="titlearea win-type-ellipsis" style="padding-left:3%;">
            <button class="win-backbutton" aria-label="Back" disabled></button>
            
            <span id="filename" class="pagetitle">Untitled</span>
            <!--<span class="chevron win-type-x-large">&#xe099;</span>-->

        </h1>
    </header>
    <section aria-label="Main content" role="main">
        <div id="editor"></div>
    </section>
    <div id="appBar" data-win-control="WinJS.UI.AppBar" data-win-options="" style="border-top: 4px #7cb800 solid;">
        <!--<button 
            data-win-control="WinJS.UI.AppBarCommand" 
            data-win-options="{id:'cmdUndo',label:'Undo',icon:'undo',
                section:'selection',tooltip:'Undo Typing'}">
        </button>
        <button 
            data-win-control="WinJS.UI.AppBarCommand" 
            data-win-options="{id:'cmdRedo',label:'Redo',icon:'redo',
                section:'selection',tooltip:'Redo Typing'}">
        </button>-->
        
        <button 
            data-win-control="WinJS.UI.AppBarCommand" 
            data-win-options="{id:'cmdNew',label:'New',icon:'page2',
                section:'global',tooltip:'Add item'}">
        </button>
        <button 
            data-win-control="WinJS.UI.AppBarCommand" 
            data-win-options="{id:'cmdSave',label:'Save',icon:'save',
                section:'selection',tooltip:'Add item'}">
        </button>
        <button 
            data-win-control="WinJS.UI.AppBarCommand" 
            data-win-options="{id:'cmdSaveAs',label:'Save As',icon:'savelocal',
                section:'selection',tooltip:'Remove item'}">
        </button>
        <!--<hr 
            data-win-control="WinJS.UI.AppBarCommand" 
            data-win-options="{type:'separator',section:'global'}" />
        <button 
            data-win-control="WinJS.UI.AppBarCommand" 
            data-win-options="{id:'cmdSearch',label:'Search',icon:'zoom',
                section:'selection',tooltip:'Delete item'}">
        </button>
        <button 
            data-win-control="WinJS.UI.AppBarCommand" 
            data-win-options="{id:'cmdPinFile',label:'Pin File',icon:'pin',
                section:'global',tooltip:'Pin this document to Start Screen'}">
        </button>-->
    </div>
    <!--<div id="searchBar" data-win-control="WinJS.UI.AppBar"
        aria-label="Navigation Bar" data-win-options="{layout:'custom',placement:'top'}" style="text-align: center;">
        <input id="searchTerms" type="text" placeholder="Search"/> <button id="findPrev">Prev</button> <button id="findNext">Next</button> <input id="replaceTerms" type="text" placeholder="Replace" /> <button>Replace</button> <button>Replace All</button>
    </div>-->
</body>
</html>
